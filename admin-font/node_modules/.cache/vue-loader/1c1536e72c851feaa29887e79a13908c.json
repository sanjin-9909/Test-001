{"remainingRequest":"D:\\uu\\springboot+vue的果蔬大棚管理系统\\admin-font\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\uu\\springboot+vue的果蔬大棚管理系统\\admin-font\\src\\components\\common\\FileUpload.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\uu\\springboot+vue的果蔬大棚管理系统\\admin-font\\src\\components\\common\\FileUpload.vue","mtime":1767581150000},{"path":"D:\\uu\\springboot+vue的果蔬大棚管理系统\\admin-font\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\uu\\springboot+vue的果蔬大棚管理系统\\admin-font\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\uu\\springboot+vue的果蔬大棚管理系统\\admin-font\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\uu\\springboot+vue的果蔬大棚管理系统\\admin-font\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoJaW1wb3J0IHN0b3JhZ2UgZnJvbSAiQC91dGlscy9zdG9yYWdlIjsNCglpbXBvcnQgYmFzZSBmcm9tICJAL3V0aWxzL2Jhc2UiOw0KCWV4cG9ydCBkZWZhdWx0IHsNCgkJZGF0YSgpIHsNCgkJCXJldHVybiB7DQoJCQkJLy8g5p+l55yL5aSn5Zu+DQoJCQkJZGlhbG9nVmlzaWJsZTogZmFsc2UsDQoJCQkJLy8g5p+l55yL5aSn5Zu+DQoJCQkJZGlhbG9nSW1hZ2VVcmw6ICIiLA0KCQkJCS8vIOe7hOS7tua4suafk+WbvueJh+eahOaVsOe7hOWtl+aute+8jOacieeJueauiuagvOW8j+imgeaxgg0KCQkJCWZpbGVMaXN0OiBbXSwNCgkJCQlmaWxlVXJsTGlzdDogW10sDQoJCQkJbXlIZWFkZXJzOiB7fQ0KCQkJfTsNCgkJfSwNCgkJcHJvcHM6IHsNCgkJCXRpcDogew0KCQkJCXR5cGU6IFN0cmluZw0KCQkJfSwNCgkJCWFjdGlvbjogew0KCQkJCXR5cGU6IFN0cmluZw0KCQkJfSwNCgkJCS8q5Zu+54mH5aSn5bCPKi8NCgkJCWxpbWl0OiB7DQoJCQkJdHlwZTogTnVtYmVyLA0KCQkJCWRlZmF1bHQ6IDMgLy9rYg0KCQkJfSwNCgkJCW11bHRpcGxlOiB7DQoJCQkJdHlwZTogQm9vbGVhbiwNCgkJCQlkZWZhdWx0OiBmYWxzZQ0KCQkJfSwNCgkJCWZpbGVVcmxzOiB7DQoJCQkJdHlwZTogU3RyaW5nDQoJCQl9LA0KCQkJdHlwZTogew0KCQkJCXR5cGU6IE51bWJlciwNCgkJCQlkZWZhdWx0OiAxDQoJCQl9LA0KCQkJZGlzYWJsZWQ6IHsNCgkJCQl0eXBlOiBCb29sZWFuLA0KCQkJCWRlZmF1bHQ6IGZhbHNlDQoJCQl9LA0KCQl9LA0KCQltb3VudGVkKCkgew0KCQkJdGhpcy5pbml0KCk7DQoJCQl0aGlzLm15SGVhZGVycyA9IHsNCgkJCQknVG9rZW4nOiBzdG9yYWdlLmdldCgiVG9rZW4iKQ0KCQkJfQ0KCQl9LA0KCQl3YXRjaDogew0KCQkJZmlsZVVybHM6IGZ1bmN0aW9uKHZhbCwgb2xkVmFsKSB7DQoJCQkJLy8gICBjb25zb2xlLmxvZygibmV3OiAlcywgb2xkOiAlcyIsIHZhbCwgb2xkVmFsKTsNCgkJCQl0aGlzLmluaXQoKTsNCgkJCX0NCgkJfSwNCgkJY29tcHV0ZWQ6IHsNCgkJCS8vIOiuoeeul+WxnuaAp+eahCBnZXR0ZXINCgkJCWdldEFjdGlvblVybDogZnVuY3Rpb24oKSB7DQoJCQkJLy8gcmV0dXJuIGJhc2UudXJsICsgdGhpcy5hY3Rpb24gKyAiP3Rva2VuPSIgKyBzdG9yYWdlLmdldCgidG9rZW4iKTsNCgkJCQlyZXR1cm4gYC8ke3RoaXMuJGJhc2UubmFtZX0vYCArIHRoaXMuYWN0aW9uOw0KCQkJfQ0KCQl9LA0KCQltZXRob2RzOiB7DQoJCQkvLyDliJ3lp4vljJYNCgkJCWluaXQoKSB7DQoJCQkJLy8gICBjb25zb2xlLmxvZyh0aGlzLmZpbGVVcmxzKTsNCgkJCQlpZiAodGhpcy5maWxlVXJscykgew0KCQkJCQl0aGlzLmZpbGVVcmxMaXN0ID0gdGhpcy5maWxlVXJscy5zcGxpdCgiLHciKS5sZW5ndGg+MT90aGlzLmZpbGVVcmxzOnRoaXMuZmlsZVVybHMuc3BsaXQoJywnKTsNCgkJCQkJbGV0IGZpbGVBcnJheSA9IFtdOw0KCQkJCQl0aGlzLmZpbGVVcmxMaXN0LmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsNCgkJCQkJCXZhciB1cmwgPSBpdGVtOw0KCQkJCQkJdmFyIG5hbWUgPSBpbmRleDsNCgkJCQkJCXZhciBmaWxlID0gew0KCQkJCQkJCW5hbWU6IG5hbWUsDQoJCQkJCQkJdXJsOiB1cmwNCgkJCQkJCX07DQoJCQkJCQlmaWxlQXJyYXkucHVzaChmaWxlKTsNCgkJCQkJfSk7DQoJCQkJCXRoaXMuc2V0RmlsZUxpc3QoZmlsZUFycmF5KTsNCgkJCQl9DQoJCQl9LA0KCQkJaGFuZGxlQmVmb3JlVXBsb2FkKGZpbGUpIHsNCg0KCQkJfSwNCgkJCS8vIOS4iuS8oOaWh+S7tuaIkOWKn+WQjuaJp+ihjA0KCQkJaGFuZGxlVXBsb2FkU3VjY2VzcyhyZXMsIGZpbGUsIGZpbGVMaXN0KSB7DQoJCQkJaWYgKHJlcyAmJiByZXMuY29kZSA9PT0gMCkgew0KCQkJCQlmaWxlTGlzdFtmaWxlTGlzdC5sZW5ndGggLSAxXVsidXJsIl0gPSAidXBsb2FkLyIgKyBmaWxlLnJlc3BvbnNlLmZpbGU7DQoJCQkJCXRoaXMuc2V0RmlsZUxpc3QoZmlsZUxpc3QpOw0KCQkJCQl0aGlzLiRlbWl0KCJjaGFuZ2UiLCB0aGlzLmZpbGVVcmxMaXN0LmpvaW4oIiwiKSk7DQoJCQkJfSBlbHNlIHsNCgkJCQkJdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubXNnKTsNCgkJCQl9DQoJCQl9LA0KCQkJLy8g5Zu+54mH5LiK5Lyg5aSx6LSlDQoJCQloYW5kbGVVcGxvYWRFcnIoZXJyLCBmaWxlLCBmaWxlTGlzdCkgew0KCQkJCXRoaXMuJG1lc3NhZ2UuZXJyb3IoIuaWh+S7tuS4iuS8oOWksei0pSIpOw0KCQkJfSwNCgkJCS8vIOenu+mZpOWbvueJhw0KCQkJaGFuZGxlUmVtb3ZlKGZpbGUsIGZpbGVMaXN0KSB7DQoJCQkJdGhpcy5zZXRGaWxlTGlzdChmaWxlTGlzdCk7DQoJCQkJdGhpcy4kZW1pdCgiY2hhbmdlIiwgdGhpcy5maWxlVXJsTGlzdC5qb2luKCIsIikpOw0KCQkJfSwNCgkJCS8vIOafpeeci+Wkp+Wbvg0KCQkJaGFuZGxlVXBsb2FkUHJldmlldyhmaWxlKSB7DQoJCQkJaWYodGhpcy50eXBlPjIpew0KCQkJCQl3aW5kb3cub3BlbihmaWxlLnVybCkNCgkJCQkJcmV0dXJuIGZhbHNlDQoJCQkJfQ0KCQkJCXRoaXMuZGlhbG9nSW1hZ2VVcmwgPSBmaWxlLnVybDsNCgkJCQl0aGlzLmRpYWxvZ1Zpc2libGUgPSB0cnVlOw0KCQkJfSwNCgkJCS8vIOmZkOWItuWbvueJh+aVsOmHjw0KCQkJaGFuZGxlRXhjZWVkKGZpbGVzLCBmaWxlTGlzdCkgew0KCQkJCXRoaXMuJG1lc3NhZ2Uud2FybmluZyhg5pyA5aSa5LiK5LygJHt0aGlzLmxpbWl0feW8oOWbvueJh2ApOw0KCQkJfSwNCgkJCS8vIOmHjeaWsOWvuWZpbGVMaXN06L+b6KGM6LWL5YC8DQoJCQlzZXRGaWxlTGlzdChmaWxlTGlzdCkgew0KCQkJCXZhciBmaWxlQXJyYXkgPSBbXTsNCgkJCQl2YXIgZmlsZVVybEFycmF5ID0gW107DQoJCQkJLy8g5pyJ5Lqb5Zu+54mH5LiN5piv5YWs5byA55qE77yM5omA5Lul6ZyA6KaB5pC65bimdG9rZW7kv6Hmga/lgZrmnYPpmZDmoKHpqowNCgkJCQl2YXIgdG9rZW4gPSBzdG9yYWdlLmdldCgidG9rZW4iKTsNCgkJCQlsZXQgX3RoaXMgPSB0aGlzOw0KCQkJCWZpbGVMaXN0LmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsNCgkJCQkJdmFyIHVybCA9IGl0ZW0udXJsLnNwbGl0KCI/IilbMF07DQoJCQkJCWlmICghdXJsLnN0YXJ0c1dpdGgoImh0dHAiKSkgew0KCQkJCQkJdXJsID0gX3RoaXMuJGJhc2UudXJsICsgdXJsDQoJCQkJCX0NCgkJCQkJdmFyIG5hbWUgPSBpdGVtLm5hbWU7DQoJCQkJCXZhciBmaWxlID0gew0KCQkJCQkJbmFtZTogbmFtZSwNCgkJCQkJCXVybDogdXJsICsgIj90b2tlbj0iICsgdG9rZW4NCgkJCQkJfTsNCgkJCQkJZmlsZUFycmF5LnB1c2goZmlsZSk7DQoJCQkJCWZpbGVVcmxBcnJheS5wdXNoKHVybCk7DQoJCQkJfSk7DQoJCQkJdGhpcy5maWxlTGlzdCA9IGZpbGVBcnJheTsNCgkJCQl0aGlzLmZpbGVVcmxMaXN0ID0gZmlsZVVybEFycmF5Ow0KCQkJfQ0KCQl9DQoJfTsNCg=="},{"version":3,"sources":["FileUpload.vue"],"names":[],"mappings":";AAyBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"FileUpload.vue","sourceRoot":"src/components/common","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<!-- 上传文件组件 -->\r\n\t\t<el-upload :disabled=\"disabled\" v-if=\"type==1\" ref=\"upload\" :action=\"getActionUrl\" list-type=\"picture-card\" :multiple=\"multiple\" :limit=\"limit\"\r\n\t\t\t:headers=\"myHeaders\" :file-list=\"fileList\" :on-exceed=\"handleExceed\" :on-preview=\"handleUploadPreview\"\r\n\t\t\t:on-remove=\"handleRemove\" :on-success=\"handleUploadSuccess\" :on-error=\"handleUploadErr\" :timeout=\"600000\"\r\n\t\t\t:before-upload=\"handleBeforeUpload\">\r\n\t\t\t<i class=\"el-icon-plus\"></i>\r\n\t\t\t<div slot=\"tip\" class=\"el-upload__tip\">{{tip}}</div>\r\n\t\t</el-upload>\r\n\t\t<el-upload :disabled=\"disabled\" v-else drag ref=\"upload\" :action=\"getActionUrl\" :multiple=\"multiple\" :limit=\"limit\"\r\n\t\t\t:headers=\"myHeaders\" :file-list=\"fileList\" :on-exceed=\"handleExceed\" :on-preview=\"handleUploadPreview\"\r\n\t\t\t:on-remove=\"handleRemove\" :on-success=\"handleUploadSuccess\" :on-error=\"handleUploadErr\" :timeout=\"600000\"\r\n\t\t\t:before-upload=\"handleBeforeUpload\">\r\n\t\t\t<i class=\"el-icon-upload\"></i>\r\n\t\t\t  <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\r\n\t\t\t<div slot=\"tip\" class=\"el-upload__tip\">{{tip}}</div>\r\n\t\t</el-upload>\r\n\t\t<el-dialog :visible.sync=\"dialogVisible\" size=\"tiny\" append-to-body>\r\n\t\t\t<img width=\"100%\" v-if=\"type==1\" :src=\"dialogImageUrl\" alt>\r\n\t\t\t<video width=\"100%\" v-if=\"type==2\" :src=\"dialogImageUrl\" alt controls />\r\n\t\t</el-dialog>\r\n\t</div>\r\n</template>\r\n<script>\r\n\timport storage from \"@/utils/storage\";\r\n\timport base from \"@/utils/base\";\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\t// 查看大图\r\n\t\t\t\tdialogVisible: false,\r\n\t\t\t\t// 查看大图\r\n\t\t\t\tdialogImageUrl: \"\",\r\n\t\t\t\t// 组件渲染图片的数组字段，有特殊格式要求\r\n\t\t\t\tfileList: [],\r\n\t\t\t\tfileUrlList: [],\r\n\t\t\t\tmyHeaders: {}\r\n\t\t\t};\r\n\t\t},\r\n\t\tprops: {\r\n\t\t\ttip: {\r\n\t\t\t\ttype: String\r\n\t\t\t},\r\n\t\t\taction: {\r\n\t\t\t\ttype: String\r\n\t\t\t},\r\n\t\t\t/*图片大小*/\r\n\t\t\tlimit: {\r\n\t\t\t\ttype: Number,\r\n\t\t\t\tdefault: 3 //kb\r\n\t\t\t},\r\n\t\t\tmultiple: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t},\r\n\t\t\tfileUrls: {\r\n\t\t\t\ttype: String\r\n\t\t\t},\r\n\t\t\ttype: {\r\n\t\t\t\ttype: Number,\r\n\t\t\t\tdefault: 1\r\n\t\t\t},\r\n\t\t\tdisabled: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t},\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tthis.init();\r\n\t\t\tthis.myHeaders = {\r\n\t\t\t\t'Token': storage.get(\"Token\")\r\n\t\t\t}\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\tfileUrls: function(val, oldVal) {\r\n\t\t\t\t//   console.log(\"new: %s, old: %s\", val, oldVal);\r\n\t\t\t\tthis.init();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t// 计算属性的 getter\r\n\t\t\tgetActionUrl: function() {\r\n\t\t\t\t// return base.url + this.action + \"?token=\" + storage.get(\"token\");\r\n\t\t\t\treturn `/${this.$base.name}/` + this.action;\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 初始化\r\n\t\t\tinit() {\r\n\t\t\t\t//   console.log(this.fileUrls);\r\n\t\t\t\tif (this.fileUrls) {\r\n\t\t\t\t\tthis.fileUrlList = this.fileUrls.split(\",w\").length>1?this.fileUrls:this.fileUrls.split(',');\r\n\t\t\t\t\tlet fileArray = [];\r\n\t\t\t\t\tthis.fileUrlList.forEach(function(item, index) {\r\n\t\t\t\t\t\tvar url = item;\r\n\t\t\t\t\t\tvar name = index;\r\n\t\t\t\t\t\tvar file = {\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\turl: url\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tfileArray.push(file);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.setFileList(fileArray);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thandleBeforeUpload(file) {\r\n\r\n\t\t\t},\r\n\t\t\t// 上传文件成功后执行\r\n\t\t\thandleUploadSuccess(res, file, fileList) {\r\n\t\t\t\tif (res && res.code === 0) {\r\n\t\t\t\t\tfileList[fileList.length - 1][\"url\"] = \"upload/\" + file.response.file;\r\n\t\t\t\t\tthis.setFileList(fileList);\r\n\t\t\t\t\tthis.$emit(\"change\", this.fileUrlList.join(\",\"));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.$message.error(res.msg);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 图片上传失败\r\n\t\t\thandleUploadErr(err, file, fileList) {\r\n\t\t\t\tthis.$message.error(\"文件上传失败\");\r\n\t\t\t},\r\n\t\t\t// 移除图片\r\n\t\t\thandleRemove(file, fileList) {\r\n\t\t\t\tthis.setFileList(fileList);\r\n\t\t\t\tthis.$emit(\"change\", this.fileUrlList.join(\",\"));\r\n\t\t\t},\r\n\t\t\t// 查看大图\r\n\t\t\thandleUploadPreview(file) {\r\n\t\t\t\tif(this.type>2){\r\n\t\t\t\t\twindow.open(file.url)\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\tthis.dialogImageUrl = file.url;\r\n\t\t\t\tthis.dialogVisible = true;\r\n\t\t\t},\r\n\t\t\t// 限制图片数量\r\n\t\t\thandleExceed(files, fileList) {\r\n\t\t\t\tthis.$message.warning(`最多上传${this.limit}张图片`);\r\n\t\t\t},\r\n\t\t\t// 重新对fileList进行赋值\r\n\t\t\tsetFileList(fileList) {\r\n\t\t\t\tvar fileArray = [];\r\n\t\t\t\tvar fileUrlArray = [];\r\n\t\t\t\t// 有些图片不是公开的，所以需要携带token信息做权限校验\r\n\t\t\t\tvar token = storage.get(\"token\");\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tfileList.forEach(function(item, index) {\r\n\t\t\t\t\tvar url = item.url.split(\"?\")[0];\r\n\t\t\t\t\tif (!url.startsWith(\"http\")) {\r\n\t\t\t\t\t\turl = _this.$base.url + url\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar name = item.name;\r\n\t\t\t\t\tvar file = {\r\n\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\turl: url + \"?token=\" + token\r\n\t\t\t\t\t};\r\n\t\t\t\t\tfileArray.push(file);\r\n\t\t\t\t\tfileUrlArray.push(url);\r\n\t\t\t\t});\r\n\t\t\t\tthis.fileList = fileArray;\r\n\t\t\t\tthis.fileUrlList = fileUrlArray;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n</style>"]}]}