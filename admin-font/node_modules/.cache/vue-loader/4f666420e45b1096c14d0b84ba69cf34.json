{"remainingRequest":"D:\\uu\\springboot+vue的果蔬大棚管理系统\\admin-font\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\uu\\springboot+vue的果蔬大棚管理系统\\admin-font\\src\\views\\modules\\chat\\chat-add-or-update.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\uu\\springboot+vue的果蔬大棚管理系统\\admin-font\\src\\views\\modules\\chat\\chat-add-or-update.vue","mtime":1767581178000},{"path":"D:\\uu\\springboot+vue的果蔬大棚管理系统\\admin-font\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\uu\\springboot+vue的果蔬大棚管理系统\\admin-font\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\uu\\springboot+vue的果蔬大棚管理系统\\admin-font\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\uu\\springboot+vue的果蔬大棚管理系统\\admin-font\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoJaW1wb3J0IHN0b3JhZ2UgZnJvbSAiQC91dGlscy9zdG9yYWdlIjsNCglpbXBvcnQgeyBQaWNrZXIgfSBmcm9tICJlbW9qaS1tYXJ0LXZ1ZSI7DQoJaW1wb3J0IHsNCgkJV2Vic29ja2V0TWl4aW4NCgl9IGZyb20gJ0AvbWl4aW5zL1dlYnNvY2tldE1peGluJw0KCWltcG9ydCB0aW1lTWV0aG9kIGZyb20gJ0AvY29tcG9uZW50cy9jb21tb24vdGltZU1ldGhvZCcNCglleHBvcnQgZGVmYXVsdCB7DQoJCW1peGluczogW1dlYnNvY2tldE1peGluXSwNCgkJZGF0YSgpIHsNCgkJCXJldHVybiB7DQoJCQkJaWQ6ICIiLA0KCQkJCXJ1bGVGb3JtOiB7DQoJCQkJCXJlcGx5OiAnJw0KCQkJCX0sDQoJCQkJZGF0YUxpc3Q6IFtdLA0KCQkJCW15SGVhZGVyczoge30sDQoJCQkJYXNrU2hvdzogZmFsc2UsDQoJCQkJc2hvd0Vtb2ppOiBmYWxzZSwNCgkJCX07DQoJCX0sDQoJCXByb3BzOiBbInBhcmVudCJdLA0KCQljb21wdXRlZDogew0KCQkJaW1nVXJsKCkgew0KCQkJCXJldHVybiB0aGlzLiRiYXNlLnVybA0KCQkJfSwNCgkJCWdldEFjdGlvblVybDogZnVuY3Rpb24oKSB7DQoJCQkJLy8gcmV0dXJuIGJhc2UudXJsICsgdGhpcy5hY3Rpb24gKyAiP3Rva2VuPSIgKyBzdG9yYWdlLmdldCgidG9rZW4iKTsNCgkJCQlyZXR1cm4gYC8ke3RoaXMuJGJhc2UubmFtZX0vYCArICdmaWxlL3VwbG9hZCc7DQoJCQl9DQoJCX0sDQoJCWNvbXBvbmVudHM6ew0KCQkJUGlja2VyDQoJCX0sDQoJCW1vdW50ZWQoKSB7DQoJCQl0aGlzLm15SGVhZGVycyA9IHsNCgkJCQknVG9rZW4nOiBzdG9yYWdlLmdldCgiVG9rZW4iKQ0KCQkJfQ0KCQl9LA0KCQlkZXN0cm95ZWQoKXsNCgkJCXRoaXMud2Vic29ja2V0T25jbG9zZSgpOw0KCQl9LA0KCQltZXRob2RzOiB7DQoJCQkvLyDliJ3lp4vljJYNCgkJCWluaXQoaWQpIHsNCgkJCQl0aGlzLmlkID0gaWQ7DQoJCQkJdGhpcy5nZXRMaXN0KCk7DQoJCQkJdGhpcy4kbmV4dFRpY2soKCk9PnsNCgkJCQkJdGhpcy5pbml0V2ViU29ja2V0KHRoaXMuaWQpDQoJCQkJfSkNCgkJCX0sDQoJCQl3ZWJzb2NrZXRPbm1lc3NhZ2U6ZnVuY3Rpb24oZSkgew0KCQkJCXRoaXMuZ2V0TGlzdCgpDQoJCQl9LA0KCQkJZ2V0TGlzdCgpIHsNCgkJCQlsZXQgcGFyYW1zID0gew0KCQkJCQlzb3J0OiAnYWRkdGltZScsDQoJCQkJCW9yZGVyOiAnYXNjJywNCgkJCQkJbGltaXQ6IDEwMDANCgkJCQl9DQoJCQkJdGhpcy4kaHR0cCh7DQoJCQkJCXVybDogdGhpcy4kYXBpLmNoYXRieXVzZXJpZHBhZ2UgKyB0aGlzLmlkLA0KCQkJCQltZXRob2Q6ICJnZXQiLA0KCQkJCQlwYXJhbXM6IHBhcmFtcw0KCQkJCX0pLnRoZW4oKHsNCgkJCQkJZGF0YQ0KCQkJCX0pID0+IHsNCgkJCQkJaWYgKGRhdGEgJiYgZGF0YS5jb2RlID09PSAwKSB7DQoJCQkJCQl0aGlzLnJ1bGVGb3JtLnVzZXJpZCA9IHRoaXMuaWQ7DQoJCQkJCQl0aGlzLmRhdGFMaXN0ID0gdGhpcy5mb3JtYXRNZXNzYWdlcyhkYXRhLmRhdGEubGlzdCk7DQoJCQkJCQlsZXQgZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY2hhdC1jb250ZW50JylbMF0NCgkJCQkJCXNldFRpbWVvdXQoKCkgPT4gew0KCQkJCQkJCWlmIChkaXYpew0KCQkJCQkJCQlkaXYuc2Nyb2xsVG9wID0gZGl2LnNjcm9sbEhlaWdodA0KCQkJCQkJCX0NCgkJCQkJCX0sIDEwMCkNCgkJCQkJfSBlbHNlIHsNCgkJCQkJCXRoaXMuJG1lc3NhZ2UuZXJyb3IoZGF0YS5tc2cpOw0KCQkJCQl9DQoJCQkJfSk7DQoJCQl9LA0KCQkJZm9ybWF0TWVzc2FnZXMobWVzc2FnZXMpIHsNCgkJCQlsZXQgbGFzdFRpbWUgPSBudWxsOw0KCQkJCW1lc3NhZ2VzLmZvckVhY2goKG1lc3NhZ2UsIGluZGV4KSA9PiB7DQoJCQkJCWNvbnN0IGN1cnJlbnRUaW1lID0gbmV3IERhdGUobWVzc2FnZS5hZGR0aW1lKS5nZXRUaW1lKCk7DQoJCQkJCWlmIChsYXN0VGltZSAhPT0gbnVsbCkgew0KCQkJCQkJY29uc3QgdGltZURpZmYgPSAoY3VycmVudFRpbWUgLSBsYXN0VGltZSkgLyAxMDAwIC8gNjA7IC8vIOi9rOaNouS4uuWIhumSnw0KCQkJCQkJaWYgKHRpbWVEaWZmIDwgMykgew0KCQkJCQkJCW1lc3NhZ2UuYWRkdGltZSA9ICcnOyAvLyDlpoLmnpzlsI/kuo4z5YiG6ZKf77yM5LiN5pi+56S65pe26Ze0DQoJCQkJCQl9DQoJCQkJCX0NCgkJCQkJbGFzdFRpbWUgPSBjdXJyZW50VGltZTsNCgkJCQl9KTsNCgkJCQlyZXR1cm4gbWVzc2FnZXM7DQoJCQl9LA0KCQkJdGltZUZvcm1hdCh0aW1lKSB7DQoJCQkJY29uc3QgVGltZSA9IHRpbWVNZXRob2QuZ2V0VGltZSh0aW1lKS5zcGxpdCgiVCIpOw0KCQkJCS8v5b2T5YmN5raI5oGv5pel5pyf5bGe5LqO5ZGoDQoJCQkJY29uc3Qgd2VlayA9IHRpbWVNZXRob2QuZ2V0RGF0ZVRvV2Vlayh0aW1lKTsNCgkJCQkvL+W9k+WJjeaXpeacnzDml7YNCgkJCQljb25zdCBudGkgPSB0aW1lTWV0aG9kLnNldFRpbWVaZXJvKHRpbWVNZXRob2QuZ2V0Tm93VGltZSgpKTsNCgkJCQkvL+a2iOaBr+aXpeacn+W9k+WkqTDml7YNCgkJCQljb25zdCBtbnRpID0gdGltZU1ldGhvZC5zZXRUaW1lWmVybyh0aW1lTWV0aG9kLmdldFRpbWUodGltZSkpOw0KCQkJCS8v6K6h566X5pel5pyf5beu5YC8DQoJCQkJY29uc3QgZGlmZkRhdGUgPSB0aW1lTWV0aG9kLmNhbGN1bGF0ZVRpbWUobnRpLCBtbnRpKTsNCgkJCQkvL+acrOWRqOS4gOaXpeacnzDml7Yg77yI5ZCO6Z2iKzHmmK/ljrvpmaTlvZPlpKnml7bpl7TvvIkNCgkJCQljb25zdCBmd250aSA9IHRpbWVNZXRob2Quc2V0VGltZVplcm8odGltZU1ldGhvZC5jb3VudERhdGVTdHIoLXRpbWVNZXRob2QuZ2V0RGF0ZVRvV2Vlayh0aW1lTWV0aG9kDQoJCQkJCS5nZXROb3dUaW1lKCkpLndlZWtJRCArIDEpKTsNCgkJCQkvL+iuoeeul+WRqOaXpeacn+W3ruWAvA0KCQkJCWNvbnN0IGRpZmZXZWVrID0gdGltZU1ldGhvZC5jYWxjdWxhdGVUaW1lKG1udGksIGZ3bnRpKTsNCgkJCQ0KCQkJCWlmIChkaWZmRGF0ZSA9PT0gMCkgeyAvL+a2iOaBr+WPkemAgeaXpeacn+WHj+WOu+W9k+WkqeaXpeacn+WmguaenOetieS6jjDliJnmmK/lvZPlpKnml7bpl7QNCgkJCQkJcmV0dXJuIFRpbWVbMV0uc2xpY2UoMCwgNSk7DQoJCQkJfSBlbHNlIGlmIChkaWZmRGF0ZSA8IDE3MjgwMDAwMCkgeyAvL+W9k+WJjeaXpeacn+WHj+WOu+a2iOaBr+WPkemAgeaXpeacn+Wwj+S6jjLlpKnvvIgxNzI4MDAwMDBtc++8ieWImeaYr+aYqOWkqS0gIOS4gOWkqeacgOWkp+W3ruWAvOWJjeWkqeWHjOaZqDAwOjAwOjAw5Yiw5LuK5aSp5pma5LiKMjM6NTk6NTkNCgkJCQkJcmV0dXJuICLmmKjlpKkgIiArIFRpbWVbMV0uc2xpY2UoMCwgNSk7DQoJCQkJfSBlbHNlIGlmIChkaWZmV2VlayA+PSAwKSB7IC8v5raI5oGv5pel5pyf5YeP5Y675pys5ZGo5LiA5pel5pyf5aSn5LqOMOWImeaYr+acrOWRqA0KCQkJCQlyZXR1cm4gd2Vlay53ZWVrTmFtZTsNCgkJCQl9IGVsc2UgeyAvL+WFtuS7luaXtumXtOWImeaYr+aXpeacnw0KCQkJCQlyZXR1cm4gVGltZVswXS5zbGljZSg1LCAxMCk7DQoJCQkJfQ0KCQkJfSwNCgkJCWFkZEVtb2ppKGUpIHsNCgkJCQl0aGlzLnJ1bGVGb3JtLnJlcGx5ICs9IGUubmF0aXZlOw0KCQkJCXRoaXMuc2hvd0Vtb2ppID0gZmFsc2UNCgkJCX0sDQoJCQkvLyDmj5DkuqQNCgkJCW9uU3VibWl0KGFzaz1udWxsLHR5cGU9MSkgew0KCQkJCXRoaXMucnVsZUZvcm0udWltYWdlID0gdGhpcy4kc3RvcmFnZS5nZXQoJ2hlYWRwb3J0cmFpdCcpDQoJCQkJdGhpcy5ydWxlRm9ybS51bmFtZSA9IHRoaXMuJHN0b3JhZ2UuZ2V0KCdhZG1pbk5hbWUnKQ0KCQkJCXRoaXMucnVsZUZvcm0udHlwZSA9IHR5cGUNCgkJCQlsZXQgcGFyYW1zID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLnJ1bGVGb3JtKSkNCgkJCQlpZihwYXJhbXMucmVwbHk9PScnJiZhc2s9PW51bGwpew0KCQkJCQl0aGlzLiRtZXNzYWdlLmVycm9yKCflhoXlrrnkuI3og73kuLrnqbonKQ0KCQkJCQlyZXR1cm4gZmFsc2UNCgkJCQl9DQoJCQkJaWYoYXNrKSB7DQoJCQkJCXBhcmFtcy5yZXBseSA9IGFzaw0KCQkJCX0NCgkJCQl0aGlzLiRodHRwKHsNCgkJCQkJdXJsOiB0aGlzLiRhcGkuY2hhdHNhdmUsDQoJCQkJCW1ldGhvZDogInBvc3QiLA0KCQkJCQlkYXRhOiBwYXJhbXMNCgkJCQl9KS50aGVuKCh7DQoJCQkJCWRhdGENCgkJCQl9KSA9PiB7DQoJCQkJCWlmIChkYXRhICYmIGRhdGEuY29kZSA9PT0gMCkgew0KCQkJCQkJdGhpcy53ZWJzb2NrZXRTZW5kKHBhcmFtcy5yZXBseSkNCgkJCQkJCXRoaXMuZ2V0TGlzdCgpOw0KCQkJCQkJdGhpcy5ydWxlRm9ybS5yZXBseSA9ICIiOw0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJdGhpcy4kbWVzc2FnZS5lcnJvcihkYXRhLm1zZyk7DQoJCQkJCX0NCgkJCQkJdGhpcy5hc2tTaG93ID0gZmFsc2UNCgkJCQl9KTsNCgkJCX0sDQoJCQl1cGxvYWRTdWNjZXNzKHJlcykgew0KCQkJCWlmIChyZXMuY29kZSA9PSAwKSB7DQoJCQkJCXRoaXMub25TdWJtaXQoJ3VwbG9hZC8nICsgcmVzLmZpbGUsMikNCgkJCQkJdGhpcy5hc2tTaG93ID0gZmFsc2UNCgkJCQl9DQoJCQl9LA0KCQkJdXBsb2FkU3VjY2VzczIocmVzKSB7DQoJCQkJaWYgKHJlcy5jb2RlID09IDApIHsNCgkJCQkJdGhpcy5vblN1Ym1pdCgndXBsb2FkLycgKyByZXMuZmlsZSwzKQ0KCQkJCQl0aGlzLmFza1Nob3cgPSBmYWxzZQ0KCQkJCX0NCgkJCX0sDQoJCQl1cGxvYWRTdWNjZXNzMyhyZXMpIHsNCgkJCQlpZiAocmVzLmNvZGUgPT0gMCkgew0KCQkJCQl0aGlzLm9uU3VibWl0KCd1cGxvYWQvJyArIHJlcy5maWxlLDQpDQoJCQkJCXRoaXMuYXNrU2hvdyA9IGZhbHNlDQoJCQkJfQ0KCQkJfSwNCgkJCS8vIOi/lOWbng0KCQkJYmFjaygpIHsNCgkJCQl0aGlzLnBhcmVudC5zaG93RmxhZyA9IGZhbHNlOw0KCQkJCXRoaXMucGFyZW50LmdldERhdGFMaXN0KCk7DQoJCQkJaWYgKHRoaXMuaW50ZXIpIHsNCgkJCQkJY2xlYXJJbnRlcnZhbCh0aGlzLmludGVyKTsNCgkJCQl9DQoJCQl9LA0KCQkJLy8g6aKE6KeIDQoJCQlkb3dubG9hZChmaWxlKXsNCgkJCQlpZighZmlsZSl7DQoJCQkJCXJldHVybiBmYWxzZQ0KCQkJCX0NCgkJCQl3aW5kb3cub3BlbigobG9jYXRpb24uaHJlZi5zcGxpdCh0aGlzLiRiYXNlLm5hbWUpLmxlbmd0aD4xID8gbG9jYXRpb24uaHJlZi5zcGxpdCh0aGlzLiRiYXNlLm5hbWUpWzBdICsgdGhpcy4kYmFzZS5uYW1lICsgJy8nICsgZmlsZSA6dGhpcy4kYmFzZS51cmwgKyBmaWxlKSkNCgkJCX0sDQoJCX0NCgl9Ow0K"},{"version":3,"sources":["chat-add-or-update.vue"],"names":[],"mappings":";AA0FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"chat-add-or-update.vue","sourceRoot":"src/views/modules/chat","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<el-form\r\n\t\t\t:style='{\"padding\":\"30px\",\"boxShadow\":\"0 0px 0px #999\",\"borderRadius\":\"6px\",\"background\":\"url(http://codegen.caihongy.cn/20221014/5e767dc0afa649ec9fbc71f9da086ab3.jpg)\"}'\r\n\t\t\tclass=\"add-update-preview\" ref=\"ruleForm\" :model=\"ruleForm\" label-width=\"80px\">\r\n\t\t\t<div class=\"chat-content\" id=\"chat-content\">\r\n\t\t\t\t<div v-bind:key=\"item.id\" v-for=\"item in dataList\">\r\n\t\t\t\t\t<div v-if=\"item.addtime\" class=\"addtime\">{{timeFormat(item.addtime)}}</div>\r\n\t\t\t\t\t<div v-if=\"item.ask\" class=\"left-content\">\r\n\t\t\t\t\t\t<div style=\"display: flex;align-items: flex-start;\">\r\n\t\t\t\t\t\t\t<img :src=\"item.uimage?$base.url + item.uimage.split(',')[0]:require('@/assets/img/service.png')\" style=\"width: 30px;height: 30px;border-radius: 50%;margin: 0 5px 0 0;\" alt=\"\">\r\n\t\t\t\t\t\t\t<el-alert v-if=\"item.type==1\" class=\"text-content\" :title=\"item.ask\" :closable=\"false\"\r\n\t\t\t\t\t\t\t\ttype=\"warning\"></el-alert>\r\n\t\t\t\t\t\t\t<el-image v-else-if=\"item.type==2\" :src=\"$base.url + item.ask\" style=\"width: 150px;height: 150px;\" fit=\"cover\" :preview-src-list=\"[$base.url + item.ask]\"></el-image>\r\n\t\t\t\t\t\t\t<video v-else-if=\"item.type==3\" :src=\"$base.url + item.ask\" style=\"width: 280px;\" controls></video>\r\n\t\t\t\t\t\t\t<el-button v-else-if=\"item.type==4\" type=\"primary\" size=\"mini\" @click=\"download(item.ask)\">文件预览</el-button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div v-else class=\"right-content\">\r\n\t\t\t\t\t\t<div style=\"display: flex;align-items: flex-start;\">\r\n\t\t\t\t\t\t\t<el-alert v-if=\"item.type==1\" class=\"text-content\" :title=\"item.reply\" :closable=\"false\"\r\n\t\t\t\t\t\t\t\ttype=\"success\"></el-alert>\r\n\t\t\t\t\t\t\t<el-image v-else-if=\"item.type==2\" :src=\"$base.url + item.reply\" style=\"width: 150px;height: 150px;\" fit=\"cover\" :preview-src-list=\"[$base.url + item.reply]\"></el-image>\r\n\t\t\t\t\t\t\t<video v-else-if=\"item.type==3\" :src=\"$base.url + item.reply\" style=\"width: 280px;\" controls></video>\r\n\t\t\t\t\t\t\t<el-button v-else-if=\"item.type==4\" type=\"primary\" size=\"mini\" @click=\"download(item.reply)\">文件预览</el-button>\r\n\t\t\t\t\t\t\t<img :src=\"item.uimage?$base.url + item.uimage.split(',')[0]:require('@/assets/img/service.png')\" style=\"width: 30px;height: 30px;border-radius: 50%;margin: 0 0 0 5px;\" alt=\"\">\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"clear-float\"></div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"clear-float\"></div>\r\n\t\t\t<el-form-item :style='{\"margin\":\"0 0 20px 0\"}' label=\"回复\" prop=\"reply\">\r\n\t\t\t\t<div style=\"width: 100%;display: flex;align-items: center;\">\r\n\t\t\t\t\t<el-input @keydown.enter.native=\"onSubmit(null,1)\" v-model=\"ruleForm.reply\" placeholder=\"回复\" clearable></el-input>\r\n\t\t\t\t\t<div style=\"position: relative;\">\r\n\t\t\t\t\t\t<span @click=\"showEmoji=!showEmoji\" class=\"icon iconfont icon-gerenzhongxin-zhihui\" style=\"font-size: 30px;color: #666;cursor: pointer;\"></span>\r\n\t\t\t\t\t\t<picker\r\n\t\t\t\t\t\t\t:include=\"['people', 'Smileys']\"\r\n\t\t\t\t\t\t\t:showSearch=\"false\"\r\n\t\t\t\t\t\t\t:showPreview=\"false\"\r\n\t\t\t\t\t\t\t:showCategories=\"false\"\r\n\t\t\t\t\t\t\t@select=\"addEmoji\"\r\n\t\t\t\t\t\t\tv-if=\"showEmoji\"\r\n\t\t\t\t\t\t\t:backgroundImageFn=\"((set,sheetSize)=>{\r\n\t\t\t\t\t\t\t\treturn require('@/assets/img/32.png')\r\n\t\t\t\t\t\t\t})\"\r\n\t\t\t\t\t\t\tstyle=\"position: absolute;bottom: 40px;left: -100px;\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item :style='{\"padding\":\"0\",\"margin\":\"0 0 20px\"}'>\r\n\t\t\t\t<div style=\"width: 100%;display: flex;align-items: center;\">\r\n\t\t\t\t\t<img style=\"width: 40px;cursor: pointer;margin-right: 10px;\" src=\"../../../assets/img/jiahao.png\" @click=\"askShow = !askShow\">\r\n\t\t\t\t\t<el-button\r\n\t\t\t\t\t\t:style='{\"border\":\"1px solid #5e9808\",\"cursor\":\"pointer\",\"padding\":\"0\",\"margin\":\"0 20px 0 0\",\"outline\":\"none\",\"color\":\"rgba(255, 255, 255, 1)\",\"borderRadius\":\"4px\",\"background\":\"-webkit-linear-gradient(top,#96d148,#4a7f06)\",\"width\":\"128px\",\"lineHeight\":\"40px\",\"fontSize\":\"14px\",\"height\":\"40px\"}'\r\n\t\t\t\t\t\ttype=\"primary\" @click=\"onSubmit(null,1)\">回复</el-button>\r\n\t\t\t\t\t<el-button\r\n\t\t\t\t\t\t:style='{\"border\":\"1px solid #ccc\",\"cursor\":\"pointer\",\"padding\":\"0\",\"margin\":\"0 0\",\"outline\":\"none\",\"color\":\"#5b8020\",\"borderRadius\":\"4px\",\"background\":\"-webkit-linear-gradient(top,#fff,#ccc)\",\"width\":\"128px\",\"lineHeight\":\"40px\",\"fontSize\":\"14px\",\"height\":\"40px\"}'\r\n\t\t\t\t\t\t@click=\"back()\">返回</el-button>\r\n\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item v-if=\"askShow\" :style='{\"padding\":\"0 0 0 50px\",\"margin\":\"0\"}'>\r\n\t\t\t\t<div style=\"display: flex\">\r\n\t\t\t\t\t<el-upload class=\"upload-demo\" :action=\"getActionUrl\" :on-success=\"uploadSuccess\" accept=\".jpg,.png\"\r\n\t\t\t\t\t\t:show-file-list=\"false\">\r\n\t\t\t\t\t\t<el-button\r\n\t\t\t\t\t\t\t:style='{\"border\":\"1px solid #5e9808\",\"cursor\":\"pointer\",\"padding\":\"0\",\"margin\":\"0 10px 0 0\",\"outline\":\"none\",\"color\":\"rgba(255, 255, 255, 1)\",\"borderRadius\":\"4px\",\"background\":\"-webkit-linear-gradient(top,#96d148,#4a7f06)\",\"width\":\"128px\",\"lineHeight\":\"40px\",\"fontSize\":\"14px\",\"height\":\"40px\"}'\r\n\t\t\t\t\t\t\ttype=\"primary\">上传图片</el-button>\r\n\t\t\t\t\t</el-upload>\r\n\t\t\t\t\t<el-upload class=\"upload-demo\" :action=\"getActionUrl\" :on-success=\"uploadSuccess2\" accept=\".mp4\"\r\n\t\t\t\t\t\t:show-file-list=\"false\">\r\n\t\t\t\t\t\t<el-button\r\n\t\t\t\t\t\t\t:style='{\"border\":\"1px solid #5e9808\",\"cursor\":\"pointer\",\"padding\":\"0\",\"margin\":\"0 10px 0 0\",\"outline\":\"none\",\"color\":\"rgba(255, 255, 255, 1)\",\"borderRadius\":\"4px\",\"background\":\"-webkit-linear-gradient(top,#96d148,#4a7f06)\",\"width\":\"128px\",\"lineHeight\":\"40px\",\"fontSize\":\"14px\",\"height\":\"40px\"}'\r\n\t\t\t\t\t\t\ttype=\"primary\">上传视频</el-button>\r\n\t\t\t\t\t</el-upload>\r\n\t\t\t\t\t<el-upload class=\"upload-demo\" :action=\"getActionUrl\" :on-success=\"uploadSuccess3\"\r\n\t\t\t\t\t\t:show-file-list=\"false\">\r\n\t\t\t\t\t\t<el-button\r\n\t\t\t\t\t\t\t:style='{\"border\":\"1px solid #5e9808\",\"cursor\":\"pointer\",\"padding\":\"0\",\"margin\":\"0 10px 0 0\",\"outline\":\"none\",\"color\":\"rgba(255, 255, 255, 1)\",\"borderRadius\":\"4px\",\"background\":\"-webkit-linear-gradient(top,#96d148,#4a7f06)\",\"width\":\"128px\",\"lineHeight\":\"40px\",\"fontSize\":\"14px\",\"height\":\"40px\"}'\r\n\t\t\t\t\t\t\ttype=\"primary\">上传文件</el-button>\r\n\t\t\t\t\t</el-upload>\r\n\t\t\t\t</div>\r\n\t\t\t</el-form-item>\r\n\t\t</el-form>\r\n\t</div>\r\n</template>\r\n<script>\r\n\timport storage from \"@/utils/storage\";\r\n\timport { Picker } from \"emoji-mart-vue\";\r\n\timport {\r\n\t\tWebsocketMixin\r\n\t} from '@/mixins/WebsocketMixin'\r\n\timport timeMethod from '@/components/common/timeMethod'\r\n\texport default {\r\n\t\tmixins: [WebsocketMixin],\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tid: \"\",\r\n\t\t\t\truleForm: {\r\n\t\t\t\t\treply: ''\r\n\t\t\t\t},\r\n\t\t\t\tdataList: [],\r\n\t\t\t\tmyHeaders: {},\r\n\t\t\t\taskShow: false,\r\n\t\t\t\tshowEmoji: false,\r\n\t\t\t};\r\n\t\t},\r\n\t\tprops: [\"parent\"],\r\n\t\tcomputed: {\r\n\t\t\timgUrl() {\r\n\t\t\t\treturn this.$base.url\r\n\t\t\t},\r\n\t\t\tgetActionUrl: function() {\r\n\t\t\t\t// return base.url + this.action + \"?token=\" + storage.get(\"token\");\r\n\t\t\t\treturn `/${this.$base.name}/` + 'file/upload';\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomponents:{\r\n\t\t\tPicker\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tthis.myHeaders = {\r\n\t\t\t\t'Token': storage.get(\"Token\")\r\n\t\t\t}\r\n\t\t},\r\n\t\tdestroyed(){\r\n\t\t\tthis.websocketOnclose();\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 初始化\r\n\t\t\tinit(id) {\r\n\t\t\t\tthis.id = id;\r\n\t\t\t\tthis.getList();\r\n\t\t\t\tthis.$nextTick(()=>{\r\n\t\t\t\t\tthis.initWebSocket(this.id)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\twebsocketOnmessage:function(e) {\r\n\t\t\t\tthis.getList()\r\n\t\t\t},\r\n\t\t\tgetList() {\r\n\t\t\t\tlet params = {\r\n\t\t\t\t\tsort: 'addtime',\r\n\t\t\t\t\torder: 'asc',\r\n\t\t\t\t\tlimit: 1000\r\n\t\t\t\t}\r\n\t\t\t\tthis.$http({\r\n\t\t\t\t\turl: this.$api.chatbyuseridpage + this.id,\r\n\t\t\t\t\tmethod: \"get\",\r\n\t\t\t\t\tparams: params\r\n\t\t\t\t}).then(({\r\n\t\t\t\t\tdata\r\n\t\t\t\t}) => {\r\n\t\t\t\t\tif (data && data.code === 0) {\r\n\t\t\t\t\t\tthis.ruleForm.userid = this.id;\r\n\t\t\t\t\t\tthis.dataList = this.formatMessages(data.data.list);\r\n\t\t\t\t\t\tlet div = document.getElementsByClassName('chat-content')[0]\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tif (div){\r\n\t\t\t\t\t\t\t\tdiv.scrollTop = div.scrollHeight\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, 100)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$message.error(data.msg);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tformatMessages(messages) {\r\n\t\t\t\tlet lastTime = null;\r\n\t\t\t\tmessages.forEach((message, index) => {\r\n\t\t\t\t\tconst currentTime = new Date(message.addtime).getTime();\r\n\t\t\t\t\tif (lastTime !== null) {\r\n\t\t\t\t\t\tconst timeDiff = (currentTime - lastTime) / 1000 / 60; // 转换为分钟\r\n\t\t\t\t\t\tif (timeDiff < 3) {\r\n\t\t\t\t\t\t\tmessage.addtime = ''; // 如果小于3分钟，不显示时间\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlastTime = currentTime;\r\n\t\t\t\t});\r\n\t\t\t\treturn messages;\r\n\t\t\t},\r\n\t\t\ttimeFormat(time) {\r\n\t\t\t\tconst Time = timeMethod.getTime(time).split(\"T\");\r\n\t\t\t\t//当前消息日期属于周\r\n\t\t\t\tconst week = timeMethod.getDateToWeek(time);\r\n\t\t\t\t//当前日期0时\r\n\t\t\t\tconst nti = timeMethod.setTimeZero(timeMethod.getNowTime());\r\n\t\t\t\t//消息日期当天0时\r\n\t\t\t\tconst mnti = timeMethod.setTimeZero(timeMethod.getTime(time));\r\n\t\t\t\t//计算日期差值\r\n\t\t\t\tconst diffDate = timeMethod.calculateTime(nti, mnti);\r\n\t\t\t\t//本周一日期0时 （后面+1是去除当天时间）\r\n\t\t\t\tconst fwnti = timeMethod.setTimeZero(timeMethod.countDateStr(-timeMethod.getDateToWeek(timeMethod\r\n\t\t\t\t\t.getNowTime()).weekID + 1));\r\n\t\t\t\t//计算周日期差值\r\n\t\t\t\tconst diffWeek = timeMethod.calculateTime(mnti, fwnti);\r\n\t\t\t\r\n\t\t\t\tif (diffDate === 0) { //消息发送日期减去当天日期如果等于0则是当天时间\r\n\t\t\t\t\treturn Time[1].slice(0, 5);\r\n\t\t\t\t} else if (diffDate < 172800000) { //当前日期减去消息发送日期小于2天（172800000ms）则是昨天-  一天最大差值前天凌晨00:00:00到今天晚上23:59:59\r\n\t\t\t\t\treturn \"昨天 \" + Time[1].slice(0, 5);\r\n\t\t\t\t} else if (diffWeek >= 0) { //消息日期减去本周一日期大于0则是本周\r\n\t\t\t\t\treturn week.weekName;\r\n\t\t\t\t} else { //其他时间则是日期\r\n\t\t\t\t\treturn Time[0].slice(5, 10);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\taddEmoji(e) {\r\n\t\t\t\tthis.ruleForm.reply += e.native;\r\n\t\t\t\tthis.showEmoji = false\r\n\t\t\t},\r\n\t\t\t// 提交\r\n\t\t\tonSubmit(ask=null,type=1) {\r\n\t\t\t\tthis.ruleForm.uimage = this.$storage.get('headportrait')\r\n\t\t\t\tthis.ruleForm.uname = this.$storage.get('adminName')\r\n\t\t\t\tthis.ruleForm.type = type\r\n\t\t\t\tlet params = JSON.parse(JSON.stringify(this.ruleForm))\r\n\t\t\t\tif(params.reply==''&&ask==null){\r\n\t\t\t\t\tthis.$message.error('内容不能为空')\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\tif(ask) {\r\n\t\t\t\t\tparams.reply = ask\r\n\t\t\t\t}\r\n\t\t\t\tthis.$http({\r\n\t\t\t\t\turl: this.$api.chatsave,\r\n\t\t\t\t\tmethod: \"post\",\r\n\t\t\t\t\tdata: params\r\n\t\t\t\t}).then(({\r\n\t\t\t\t\tdata\r\n\t\t\t\t}) => {\r\n\t\t\t\t\tif (data && data.code === 0) {\r\n\t\t\t\t\t\tthis.websocketSend(params.reply)\r\n\t\t\t\t\t\tthis.getList();\r\n\t\t\t\t\t\tthis.ruleForm.reply = \"\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$message.error(data.msg);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.askShow = false\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tuploadSuccess(res) {\r\n\t\t\t\tif (res.code == 0) {\r\n\t\t\t\t\tthis.onSubmit('upload/' + res.file,2)\r\n\t\t\t\t\tthis.askShow = false\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tuploadSuccess2(res) {\r\n\t\t\t\tif (res.code == 0) {\r\n\t\t\t\t\tthis.onSubmit('upload/' + res.file,3)\r\n\t\t\t\t\tthis.askShow = false\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tuploadSuccess3(res) {\r\n\t\t\t\tif (res.code == 0) {\r\n\t\t\t\t\tthis.onSubmit('upload/' + res.file,4)\r\n\t\t\t\t\tthis.askShow = false\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 返回\r\n\t\t\tback() {\r\n\t\t\t\tthis.parent.showFlag = false;\r\n\t\t\t\tthis.parent.getDataList();\r\n\t\t\t\tif (this.inter) {\r\n\t\t\t\t\tclearInterval(this.inter);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 预览\r\n\t\t\tdownload(file){\r\n\t\t\t\tif(!file){\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\twindow.open((location.href.split(this.$base.name).length>1 ? location.href.split(this.$base.name)[0] + this.$base.name + '/' + file :this.$base.url + file))\r\n\t\t\t},\r\n\t\t}\r\n\t};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\t.emoji-mart[data-v-7bc71df8] {\r\n\t\tfont-family: -apple-system, BlinkMacSystemFont, \"Helvetica Neue\", sans-serif;\r\n\t\tdisplay: -ms-flexbox;\r\n\t\tdisplay: flex;\r\n\t\t-ms-flex-direction: column;\r\n\t\tflex-direction: column;\r\n\t\theight: 420px;\r\n\t\tcolor: #ffffff !important;\r\n\t\tborder: 1px solid #d9d9d9;\r\n\t\tborder-radius: 5px;\r\n\t\tbackground: #fff;\r\n\t}\r\n\t.chat-content {\r\n\t\tmargin-left: 80px;\r\n\t\tpadding-bottom: 20px;\r\n\t\twidth: 500px;\r\n\t\tmargin-bottom: 30px;\r\n\t\tmax-height: 300px;\r\n\t\theight: 300px;\r\n\t\toverflow-y: scroll;\r\n\t\tborder: 1px solid #eeeeee;\r\n\t\tbackground: #fff;\r\n\r\n\t\t.left-content {\r\n\t\t\tfloat: left;\r\n\t\t\tmargin-bottom: 10px;\r\n\t\t\tpadding: 10px;\r\n\t\t}\r\n\r\n\t\t.right-content {\r\n\t\t\tfloat: right;\r\n\t\t\tmargin-bottom: 10px;\r\n\t\t\tpadding: 10px;\r\n\t\t}\r\n\t}\r\n\r\n\t.clear-float {\r\n\t\tclear: both;\r\n\t}\r\n\r\n\t.detail-form-content {\r\n\t\tbackground-color: transparent;\r\n\t}\r\n\r\n\t.el-input {\r\n\t\twidth: auto;\r\n\t}\r\n\r\n\t.add-update-preview .el-form-item /deep/ .el-form-item__label {\r\n\t\tpadding: 0 10px 0 0;\r\n\t\ttext-shadow: 0 1px 10px #fff;\r\n\t\tcolor: #699620;\r\n\t\twidth: 80px;\r\n\t\tfont-size: 14px;\r\n\t\tline-height: 40px;\r\n\t\ttext-align: right;\r\n\t}\r\n\r\n\t.add-update-preview .el-form-item /deep/ .el-form-item__content {\r\n\t\tmargin-left: 80px;\r\n\t}\r\n\r\n\t.add-update-preview .el-input /deep/ .el-input__inner {\r\n\t\tborder: 0;\r\n\t\tborder-radius: 4px;\r\n\t\tpadding: 0 12px;\r\n\t\tbox-shadow: 0 0 1px #4b681d;\r\n\t\toutline: none;\r\n\t\tcolor: #00a9aa;\r\n\t\twidth: 400px;\r\n\t\tfont-size: 14px;\r\n\t\theight: 40px;\r\n\t}\r\n\r\n\t.add-update-preview .el-select /deep/ .el-input__inner {\r\n\t\tborder: 0;\r\n\t\tborder-radius: 4px;\r\n\t\tpadding: 0 10px;\r\n\t\tbox-shadow: 0 0 1px #4b681d;\r\n\t\toutline: none;\r\n\t\tcolor: #00a9aa;\r\n\t\twidth: 200px;\r\n\t\tfont-size: 14px;\r\n\t\theight: 40px;\r\n\t}\r\n\r\n\t.add-update-preview .el-date-editor /deep/ .el-input__inner {\r\n\t\tborder: 0;\r\n\t\tborder-radius: 4px;\r\n\t\tpadding: 0 10px 0 30px;\r\n\t\tbox-shadow: 0 0 1px #4b681d;\r\n\t\toutline: none;\r\n\t\tcolor: #00a9aa;\r\n\t\twidth: 200px;\r\n\t\tfont-size: 14px;\r\n\t\theight: 40px;\r\n\t}\r\n\r\n\t.add-update-preview /deep/ .el-upload--picture-card {\r\n\t\tbackground: transparent;\r\n\t\tborder: 0;\r\n\t\tborder-radius: 0;\r\n\t\twidth: auto;\r\n\t\theight: auto;\r\n\t\tline-height: initial;\r\n\t\tvertical-align: middle;\r\n\t}\r\n\r\n\t.add-update-preview /deep/ .upload .upload-img {\r\n\t\tborder: 1px dashed #fff;\r\n\t\tcursor: pointer;\r\n\t\tborder-radius: 6px;\r\n\t\tcolor: #fff;\r\n\t\twidth: 200px;\r\n\t\tfont-size: 32px;\r\n\t\tline-height: 100px;\r\n\t\ttext-align: center;\r\n\t\theight: 100px;\r\n\t}\r\n\r\n\t.add-update-preview /deep/ .el-upload-list .el-upload-list__item {\r\n\t\tborder: 1px dashed #fff;\r\n\t\tcursor: pointer;\r\n\t\tborder-radius: 6px;\r\n\t\tcolor: #fff;\r\n\t\twidth: 200px;\r\n\t\tfont-size: 32px;\r\n\t\tline-height: 100px;\r\n\t\ttext-align: center;\r\n\t\theight: 100px;\r\n\t}\r\n\r\n\t.add-update-preview /deep/ .el-upload .el-icon-plus {\r\n\t\tborder: 1px dashed #fff;\r\n\t\tcursor: pointer;\r\n\t\tborder-radius: 6px;\r\n\t\tcolor: #fff;\r\n\t\twidth: 200px;\r\n\t\tfont-size: 32px;\r\n\t\tline-height: 100px;\r\n\t\ttext-align: center;\r\n\t\theight: 100px;\r\n\t}\r\n\r\n\t.add-update-preview .el-textarea /deep/ .el-textarea__inner {\r\n\t\tborder: 0;\r\n\t\tborder-radius: 4px;\r\n\t\tpadding: 12px;\r\n\t\tbox-shadow: 0 0 1px #4b681d;\r\n\t\toutline: none;\r\n\t\tcolor: #00a9aa;\r\n\t\twidth: 400px;\r\n\t\tfont-size: 14px;\r\n\t\theight: auto;\r\n\t}\r\n\t.addtime {\r\n\t\twidth: 100%;\r\n\t\ttext-align: center;\r\n\t\tfont-size: 12px;\r\n\t\tcolor: #999;\r\n\t}\r\n</style>"]}]}